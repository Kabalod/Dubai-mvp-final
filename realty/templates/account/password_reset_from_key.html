{% extends "base.html" %}
{% load allauth i18n %}
{% block head_title %}
    {% translate "Change Password" %}
{% endblock head_title %}

{% block content %}
    <h1 class="mb-8 text-3xl font-bold text-center text-blue-400">
        {% if token_fail %}
            {% translate "Bad Token" %}
        {% else %}
            {% translate "Change Password" %}
        {% endif %}
    </h1>
    <div class="p-8 mx-auto max-w-md bg-gray-800 rounded-xl border border-gray-700 shadow-lg">
        {% if token_fail %}
            {% url 'account_reset_password' as passwd_reset_url %}
            <p class="mb-6 text-center text-gray-300">
                {% blocktranslate %}The password reset link was invalid, possibly because it has already been used.  Please request a <a href="{{ passwd_reset_url }}" class="text-blue-400 underline hover:text-blue-300">new password reset</a>.{% endblocktranslate %}
            </p>
        {% else %}
            <form method="post" action="{{ action_url }}" class="space-y-8">
                {% csrf_token %}
                {{ redirect_field }}
                {% for field in form.visible_fields %}
                    <div class="flex flex-col gap-1 mb-6">
                        <label for="{{ field.id_for_label }}" class="font-medium text-gray-300">{{ field.label }}</label>
                        {{ field }}
                        {% if field.help_text %}<p class="text-xs text-gray-400">{{ field.help_text }}</p>{% endif %}
                        {% for error in field.errors %}<p class="text-xs text-red-400">{{ error }}</p>{% endfor %}
                    </div>
                {% endfor %}
                {% for field in form.hidden_fields %}{{ field }}{% endfor %}
                <div class="flex flex-col gap-4 mt-10 md:flex-row">
                    <button type="submit"
                            name="action"
                            class="py-2 px-4 w-full font-semibold text-white bg-blue-500 rounded-lg transition hover:bg-blue-600 focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 focus:outline-none">
                        {% translate 'Change Password' %}
                    </button>
                    <button type="submit"
                            form="logout-from-stage"
                            class="py-2 px-4 w-full font-semibold text-blue-400 bg-transparent rounded-lg border border-blue-500 transition hover:bg-blue-900">
                        {% translate "Cancel" %}
                    </button>
                </div>
            </form>
        {% endif %}
    </div>
    {% if not cancel_url %}
        <form id="logout-from-stage"
              method="post"
              action="{% url 'account_logout' %}">
            <input type="hidden" name="next" value="{% url 'account_login' %}">
            {% csrf_token %}
        </form>
    {% endif %}
{% endblock content %}
