{% extends "base.html" %}

{% block head_title %}
    Metric detail: {{ metric }}
{% endblock head_title %}

{% block content %}
    <div class="container p-8 mx-auto mt-8 max-w-2xl bg-gray-800 rounded-xl shadow-lg">
        <a class="inline-block mb-4 text-blue-400 hover:underline"
           href="javascript:history.back()">‚Üê Back</a>
        <h1 class="mb-6 text-2xl font-bold">Metric: {{ metric }}</h1>
        <div class="p-6 bg-gray-900 rounded-lg">
            <div id="chart-container" class="mx-auto w-full max-w-xl">
                <canvas id="metricChart"></canvas>
            </div>
        </div>
    </div>
{% endblock content %}

{% block extra_body %}
    <script>
    document.addEventListener("DOMContentLoaded", function(){
    const metricName = "{{ metric }}";
    const url = "/stats/?metric=" + encodeURIComponent(metricName);

    fetch(url)
      .then(resp => resp.json())
      .then(data => {
          const ctx = document.getElementById("metricChart").getContext("2d");
          new Chart(ctx, {
              type: "line",
              data: {
                  labels: data.labels,
                  datasets: [{
                      label: metricName,
                      data: data.data,
                      borderColor: '#38bdf8',
                      backgroundColor: 'rgba(56,189,248,0.2)',
                      tension: 0.3
                  }]
              },
              options: {
                  responsive: true,
                  plugins: {
                      legend: { labels: { color: '#f1f5f9' } }
                  },
                  scales: {
                      x: { ticks: { color: '#f1f5f9' }, grid: { color: '#334155' } },
                      y: { beginAtZero: false, ticks: { color: '#f1f5f9' }, grid: { color: '#334155' } }
                  }
              }
          });
      })
      .catch(err => {
          console.error(err);
      });
});
    </script>
{% endblock extra_body %}
